"use strict";var _interopRequireDefault=require("@babel/runtime/helpers/interopRequireDefault");var _defineProperty2=_interopRequireDefault(require("@babel/runtime/helpers/defineProperty"));require("core-js/modules/es.array.iterator"),require("core-js/modules/es.array.sort"),require("core-js/modules/es.object.entries"),require("core-js/modules/es.object.get-own-property-descriptors"),require("core-js/modules/es.string.split");function ownKeys(a,b){var c=Object.keys(a);if(Object.getOwnPropertySymbols){var d=Object.getOwnPropertySymbols(a);b&&(d=d.filter(function(b){return Object.getOwnPropertyDescriptor(a,b).enumerable})),c.push.apply(c,d)}return c}function _objectSpread(a){for(var b,c=1;c<arguments.length;c++)b=null==arguments[c]?{}:arguments[c],c%2?ownKeys(Object(b),!0).forEach(function(c){(0,_defineProperty2.default)(a,c,b[c])}):Object.getOwnPropertyDescriptors?Object.defineProperties(a,Object.getOwnPropertyDescriptors(b)):ownKeys(Object(b)).forEach(function(c){Object.defineProperty(a,c,Object.getOwnPropertyDescriptor(b,c))});return a}const{extname}=require("path"),{invertObj,takeWhile}=require("ramda"),NPC_DOMAIN="http://www.public.navy.mil",MAX_MESSAGE_TEXT_LENGTH=5e3,MESSAGE_TYPE_LOOKUP={NAV:"NAVADMIN",ALN:"ALNAV"},YEAR_FORMAT_LENGTH=2,createMessageId=({type:a,year:b,num:c})=>`${a}${b}${c}`,createNpcPageUrl=({type:a,year:b})=>{// eslint-disable-line no-magic-numbers
return`${NPC_DOMAIN}/bupers-npc/reference/messages/${a}S/Pages/${a}20${(a=>(a+"").length===4?+a.substr(-2):a)(b)}.aspx`},createMessageUrl=({num:a,type:b,year:c})=>{const d=invertObj(MESSAGE_TYPE_LOOKUP)[b],e=parseInt(c,10),f="NAV"===d,g=18>e,h=`bupers-npc/reference/messages/Documents${f&&g?"2":""}`;return`${NPC_DOMAIN}/${h}/${f&&!g||"ALN"===d?`${b}S/`:""}${d}20${c}/${d}${c}${a}.txt`},createYearsString=a=>a.sort().slice(0,-1).map(a=>`20${a}`).join(", ").concat(`${2<a.length?",":""}${1<a.length?" and ":""}20${a.slice(-1)}`),dict=a=>new Map(Object.entries(a)),getCurrentYear=()=>+(new Date().getFullYear()+"").substring(2),isNotNumber=a=>isNaN(+a),isNumberLike=a=>!isNaN(+a),parseMessageName=a=>{const b=takeWhile(isNotNumber,[...a]).join("").toUpperCase(),c=MESSAGE_TYPE_LOOKUP[b],d=a.substring(b.length,b.length+YEAR_FORMAT_LENGTH),e=a.substring(b.length+YEAR_FORMAT_LENGTH),f=createMessageUrl({num:e,type:c,year:d}),g=createMessageId({num:e,type:c,year:d});return{code:b,id:g,num:e,type:c,url:f,year:d}},parseMessageId=a=>{const b=takeWhile(isNotNumber,[...a]).join("").toUpperCase(),c=invertObj(MESSAGE_TYPE_LOOKUP)[b],d=a.substring(b.length,b.length+YEAR_FORMAT_LENGTH),e=a.substring(b.length+YEAR_FORMAT_LENGTH);return parseMessageName(`${c}${d}${e}`)},parseMessageUri=a=>{const[b]=a.split("/").reverse(),[c]=b.split("."),d=extname(a);return _objectSpread({},parseMessageName(c),{ext:d})},partitionByKeyLength=(a,b,c)=>{const d=c[a]+"",e=Math.ceil(d.length/b);return[..."x".repeat(e)].map((e,f)=>{const g=f*b;return _objectSpread({},c,{[a]:d.substring(g,g+b)})})};module.exports={MAX_MESSAGE_TEXT_LENGTH,NPC_DOMAIN,createMessageId,createMessageUrl,createNpcPageUrl,createYearsString,dict,getCurrentYear,isNotNumber,isNumberLike,parseMessageId,parseMessageName,parseMessageUri,partitionByKeyLength};